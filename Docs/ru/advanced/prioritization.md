## Критичность событий

События могут быть помечены как критичные с помощью флага `isCritical` для обозначения необходимости немедленной обработки.

### Некритичные события (по умолчанию)

Обычные события, которые могут быть буферизованы или отправлены пакетами.

```swift
logger.log()
    .event("user_action")
    .info("Пользователь прокрутил до конца")
// isCritical = false по умолчанию
```

### Критичные события

События, требующие немедленной обработки (сбои, критическая аналитика).

```swift
logger.log()
    .event("payment")
    .critical()
    .error("Сбой обработки платежа")
// isCritical = true
```

Или используя методы быстрого доступа:

```swift
// Методы error по умолчанию критичные
logger.error("Сбой платежа", isCritical: true)

// Другие методы по умолчанию некритичные
logger.info("Действие пользователя", isCritical: false)
```

## Интерпретация перехватчиками

Каждый перехватчик может интерпретировать критичность по-разному:

### Пример сетевого перехватчика

```swift
final class NetworkInterceptor: LetopisInterceptor {
    func handle(_ logEvent: LogEvent) {
        if logEvent.isCritical {
            // Отправить немедленно
            sendImmediately(logEvent)
        } else {
            // Поставить в очередь для пакетной отправки
            addToQueue(logEvent)
        }
    }
}
```

### Пример дискового перехватчика

```swift
final class DiskInterceptor: LetopisInterceptor {
    func handle(_ logEvent: LogEvent) {
        // Сохранить всё
        saveToDisk(logEvent)
        
        // Запустить синхронизацию только для критических событий
        if logEvent.isCritical {
            triggerBackgroundSync()
        }
    }
}
```

### Пример консольного перехватчика

```swift
let consoleInterceptor = ConsoleInterceptor(
    criticalOnly: true  // Печатать только критические события
)
```

## Интеграция с OSLog

При использовании `ConsoleInterceptor` с OSLog критичность влияет на уровень лога:

```swift
let consoleInterceptor = ConsoleInterceptor(
    useOSLog: true,
    subsystem: "com.yourapp.identifier",
    category: "Analytics"
)
```

**Соответствие уровней:**
- `.debug` → `.debug`
- `.info` → `.info`  
- `.warning` → `.default` (или `.error` если критично)
- `.error` → `.error` (или `.fault` если критично)

Критичные события повышаются до более высоких уровней OSLog для лучшей видимости.

## Лучшие практики

1. **Используйте некритичные для большинства логов**: Резервируйте флаг критичности для действительно важных событий
2. **Определите четкие критерии**: Задокументируйте, когда помечать события как критичные
3. **Тестируйте обработку критичности**: Проверьте, что перехватчики корректно работают
4. **Учитывайте влияние на пользователя**: Критичные события должны оправдывать затраты на производительность

## Распространенные случаи использования

### Критичные события
- Сбои платежей
- Нарушения безопасности
- Повреждение данных
- Отключения сервисов
- Фатальные ошибки

### Некритичные события
- Взаимодействия пользователя
- Вызовы API
- Отладочная информация
- Метрики производительности
- Использование функций

---

[Назад к индексу документации](../index.md)
